#!/usr/bin/env bash

set -euo pipefail

echo Bootstrapping shelly...

hash git || (
  echo "Please ensure git is installed" >&2
  exit 1
)

export SHELLY_DEV_DIR=~/Code
SHELLY_HOME=${SHELLY_DEV_DIR}/steshaw/shelly

if [[ ! -d $SHELLY_HOME ]]; then
  git clone https://github.com/steshaw/shelly.git "$SHELLY_HOME"
  (
    cd "$SHELLY_HOME"
    git remote set-url origin git@github.com:steshaw/shelly.git
  )
  # Git doesn't remember the file attributes of directories
  chmod 700 $SHELLY_HOME/dotfiles/.gnupg
fi

PATH=${SHELLY_HOME}/bin:${PATH}
ShellyLinkDotFiles
