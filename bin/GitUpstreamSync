#!/usr/bin/env bash

set -eu

function Usage {
  echo "usage: $(basename $0) [branch]" >&2
  exit 2
}

#
# Be nice to have a -n option that prevent execution. But `getopts` is yuk. Need Turtle.
#

if [[ $# -eq 0 ]]; then
  branch=master
elif [[ $# -eq 1 ]]; then
  branch=$1
else
  Usage
fi

git checkout ${branch}
git pull --rebase
git fetch upstream
git rebase upstream/${branch}
git pull --rebase
git push
