#!/bin/bash -ue

$DEBUG

if [[ $# -ne 1 ]]; then
  echo "usage: $(basename $0) cabal-package-name" >&2
  exit 2
fi

pkg=${1}

function bail() {
set -x
  msg=$1
  echo "${msg}" >&2
  exit 1
}

dir=~/.shelly/cabal-sandboxes/${pkg}
echo dir="[[${dir}]]"

if [[ -d ${dir} ]]; then
  bail "Package ${pkg} seems to be installed already. ${dir} exists."
fi

mkdir -p ${dir}
cd ${dir}
cabal sandbox init
cabal install ${pkg}
