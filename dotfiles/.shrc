#!/usr/bin/env ksh

#
# Should be suitable for bash and zsh.
#

Echo "Executing ~/.shrc"

setEditor() {
  editor=$1
  Echo "Trying $editor"
  if has "$editor"; then
    export VISUAL
    VISUAL=$(command -v "$editor")
    Echo "VISUAL = $VISUAL"
    return 0
  else
    Echo "We don't have $editor"
    return 1
  fi
}

unset EDITOR
unset VISUAL
setEditor nvim || setEditor vim
[[ -n $VISUAL ]] && export EDITOR=$VISUAL

# Friendly reminder on macOS that we're switching to neovim.
[[ $(uname) == Darwin ]] && alias vim='echo Use nvim: -- nvim '

set -o vi

# Aliases

alias vi='v'

# This also ensures that we switch the "standard" oh-my-zsh ls aliases
# as we want the shortest one for the most common command! i.e. l.
alias ls || true
alias ls='ls --color -Fh'
alias ls
alias l || true
alias l='ls -l'
alias l
alias ll || true
alias ll='l -A' # and prefer -A to -a. Don't need '.' and '..' often.
alias ll
alias la || true
alias la='l -a'
alias la

alias wi='type -ap'

# Make file ops safer.
alias cp='cp -i'
alias mv='mv -i'
alias rm='rm -i'

alias cx='chmod +x'
alias cw='chmod +w'

alias vp='v ~/.profile' # Vi Profile
alias sp='source ~/.profile' # Source Profile

alias vbp=vp # Was: Vi Bash Profile
alias sbp=sp # Was: Source Bash Profile

alias vbrc='v ~/.bashrc' # Vi BashRC
alias sbrc='source ~/.bashrc' # Source BashRC

alias szrc="source ~/.zshrc" # Source ZshRC
alias vzrc="\${VISUAL} ~/.zshrc" # Vi ZshRC
alias ohmyzsh="\${VISUAL} ~/.oh-my-zsh"

# Some here are my commonly used ones from oh-my-zsh git plugin for use in bash.
alias gaa || true
alias gaa='git add --all'
alias gaa
alias gst || true
alias gst='git status'
alias gst
alias gd || true
alias gd='git diff'
alias gd
alias gds || true
alias gds='git diff --staged'
alias gds

alias path='echo $PATH | tr : "\n"'
alias cdpath='echo $CDPATH | tr : "\n"'

if [[ "$(uname)" != 'Darwin' ]]; then
  alias pbcopy='xsel --clipboard --input'
  alias pbpaste='xsel --clipboard --output'
fi

alias sml='rlwrap sml'
alias ocaml='rlwrap ocaml'

# This cdpath array works out-of-box for zsh.
# For bash, it's processed into CDPATH.
cdpath=(
  .
  ~/dev
  ~/dev/steshaw
  ~/dev/tlcsrc
  ~/dev/betterteamapp
  ~/dev/betterteamapp/solo/workers
)
if isBash; then
  CDPATH=$(IFS=':'; echo "${cdpath[*]}")
  unset cdpath
fi

sourceExists ~/.travis/travis.sh # for travis gem
sourceExists ~/.shrc.local
